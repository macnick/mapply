(()=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return r(this,n)}}function r(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?i(e):n}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,d(t,e,"get"))}function f(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,d(t,e,"set"),n),n}function d(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var h=document.querySelector(".form"),v=document.querySelector(".workouts"),_=document.querySelector(".form__input--type"),y=document.querySelector(".form__input--distance"),m=document.querySelector(".form__input--duration"),k=document.querySelector(".form__input--cadence"),w=document.querySelector(".form__input--elevation"),g=new WeakMap,b=new WeakMap,S=new WeakMap,O=function(){function t(){var e=this;s(this,t),g.set(this,{writable:!0,value:void 0}),b.set(this,{writable:!0,value:void 0}),S.set(this,{writable:!0,value:[]}),this._getPosition(),h.addEventListener("submit",(function(t){return e._newWorkout(t)})),_.addEventListener("change",this._toggleElevation),v.addEventListener("click",(function(t){return e._moveToMarker(t)}))}return l(t,[{key:"_getPosition",value:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(this._loadMap.bind(this),(function(){return console.log("there was an error getting your position ")}))}},{key:"_loadMap",value:function(t){var e=this,n=t.coords,o=n.latitude,r=n.longitude;f(this,g,L.map("map").setView([o,r],14)),L.tileLayer("http://{s}.google.com/vt/lyrs=".concat("s,h","&x={x}&y={y}&z={z}"),{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}).addTo(p(this,g)),L.marker([o,r]).addTo(p(this,g)).bindPopup("You are here!").openPopup(),this._loadWorkouts(),p(this,g).on("click",(function(t){return e._showForm(t)}))}},{key:"_showForm",value:function(t){h.classList.remove("hidden"),y.focus(),f(this,b,t.latlng)}},{key:"_toggleElevation",value:function(){k.closest(".form__row").classList.toggle("form__row--hidden"),w.closest(".form__row").classList.toggle("form__row--hidden")}},{key:"_clearForm",value:function(){y.value="",m.value="",k.value="",w.value="",h.classList.add("hidden")}},{key:"_notValid",value:function(t){return isNaN(t)||t<=0}},{key:"_newWorkout",value:function(t){t.preventDefault();var e=_.value,n=+y.value,o=+m.value;if(this._notValid(o)||this._notValid(n))return alert("Inputs have to be positive numbers!");if("running"===e){var r=+k.value;if(this._notValid(r))return alert("Cadence must be a positive number!");var i=new W(p(this,b),n,o,r,e);p(this,S).push(i),this._renderWorkoutMarker(i)}if("cycling"===e){var a=+w.value;if(isNaN(a))return alert("Elevation must be a number!");var u=new M(p(this,b),n,o,a,e);p(this,S).push(u),this._renderWorkoutMarker(u)}}},{key:"_renderWorkoutMarker",value:function(t){var e=t.coords,n=e.lat,o=e.lng;L.marker([n,o]).addTo(p(this,g)).bindPopup(L.popup({maxWidth:250,minWidth:120,riseOnHover:!0,autoClose:!1,closeOnClick:!1,className:"".concat(t.type,"-popup")})).setPopupContent("".concat("running"===t.type?"üèÉ‚Äç‚ôÇÔ∏è":"üö¥‚Äç‚ôÄÔ∏è"," ").concat(t.description)).openPopup(),this._clearForm(),this._renderWorkout(t),this._storeWorkouts()}},{key:"_renderWorkout",value:function(t){var e=t.type,n='\n    <li class="workout workout--'.concat(e,'" data-id="').concat(t.id,'">\n    <h2 class="workout__title">').concat(t.description,'</h2>\n    <div class="workout__details">\n      <span class="workout__icon">').concat("running"===e?"üèÉ‚Äç‚ôÇÔ∏è":"üö¥‚Äç‚ôÄÔ∏è",'</span>\n      <span class="workout__value">').concat(t.distance,'</span>\n      <span class="workout__unit">km</span>\n    </div>\n    <div class="workout__details">\n      <span class="workout__icon">‚è±</span>\n      <span class="workout__value">').concat(t.duration,'</span>\n      <span class="workout__unit">min</span>\n    </div>\n    <div class="workout__details">\n            <span class="workout__icon">‚ö°Ô∏è</span>\n            <span class="workout__value">').concat("running"===e?t.pace.toFixed(1):t.speed.toFixed(1),'</span>\n            <span class="workout__unit">').concat("running"===e?"min/km":"km/h",'</span>\n          </div>\n          <div class="workout__details">\n            <span class="workout__icon">').concat("running"===e?"üëü":"‚õ∞",'</span>\n            <span class="workout__value">178</span>\n            <span class="workout__unit">').concat("running"===e?"spm":"m","</span>\n          </div>\n        </li>\n    ");h.style.display="none",h.insertAdjacentHTML("afterend",n),setTimeout((function(){return h.style.display="grid"}),700)}},{key:"_moveToMarker",value:function(t){var e=t.target.closest(".workout");if(e){var n=p(this,S).find((function(t){return t.id==e.dataset.id}));p(this,g).setView(n.coords,14,{animate:!0,pan:{duration:1}})}}},{key:"_storeWorkouts",value:function(){localStorage.setItem("workouts",JSON.stringify(p(this,S)))}},{key:"_loadWorkouts",value:function(){var t=this,e=JSON.parse(localStorage.getItem("workouts"));e&&(f(this,S,e),p(this,S).forEach((function(e){t._renderWorkoutMarker(e)})))}},{key:"reset",value:function(){localStorage.removeItem("workouts")}}]),t}(),P=function(){function t(e,n,o){s(this,t),u(this,"date",new Date),u(this,"id",Date.now().toString().slice(-9)),this.coords=e,this.distance=n,this.duration=o}return l(t,[{key:"_setDescription",value:function(){this.description="".concat(this.type[0].toUpperCase()).concat(this.type.slice(1)," on ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][this.date.getMonth()]," ").concat(this.date.getDate())}}]),t}(),W=function(t){e(r,t);var n=o(r);function r(t,e,o,a){var c;return s(this,r),u(i(c=n.call(this,t,e,o)),"type","running"),c.cadence=a,c.calcPace(),c._setDescription(),c}return l(r,[{key:"calcPace",value:function(){return this.pace=this.duration/this.distance,this}}]),r}(P),M=function(t){e(r,t);var n=o(r);function r(t,e,o,a){var c;return s(this,r),u(i(c=n.call(this,t,e,o)),"type","cycling"),c.elevGain=a,c.calcSpeed(),c._setDescription(),c}return l(r,[{key:"calcSpeed",value:function(){this.speed=this.distance/this.duration*60}}]),r}(P);new O})();